<html>
<head>
<style>
* { margin: 0; padding: 0; }
html, body {
  background-color: #fff;
  margin: 0;
  padding: 0;
  font-size: 1.05em;
  color: #333;
  min-width: 600px;
  padding: 0 1em;
  margin: 0 auto;
  width: 80%;
}
</style>
</head>

<body>

<h1>What is in a <i>science paper</i> name?</h1>

<br>
<p>Look no further for a name for your next Science/Nature paper.</p>
<br>

<h3>Click a button to generate a title and abstract for that subject:</h3>
<br>
<script>
function loadJSON(path, success, error)
{
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function()
    {
        if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
                if (success)
                    success(JSON.parse(xhr.responseText));
            } else {
                if (error)
                    error(xhr);
            }
        }
    };
    xhr.open("GET", path, true);
    xhr.send();
}

var titles;
var titlesLength;
var subjectData = []; // create an empty array
var subjectAbstract = []
function showRandomTitle(subject,color){
  if ((subject in subjectData)==false) {
    document.getElementById("loading").innerHTML = 'Loading...'
    loadJSON(subject+'_title_markov.json',
             function(data) { 
                subjectData[subject]=data;
                    loadJSON(subject+'_abstract_markov.json',
                             function(data) { 
                                subjectAbstract[subject]=data;
                                document.getElementById("loading").innerHTML='<div style="font-size:22pt;min-height:40px;width:100%;" id="title"></div><br\><br\>';
                                showRandom(subject,color);
                             },
                             function(xhr) { console.error(xhr); }
                    );
             },
             function(xhr) { console.error(xhr); }
    );
  } else {
    showRandom(subject,color);
  }
}

function showRandom(subject,color) {
    whichTitle=Math.round(Math.random()*(subjectData[subject].length-1));
    whichAbstract=Math.round(Math.random()*(subjectAbstract[subject].length-1));
    document.getElementById("loading").innerHTML='<div style="word-wrap: break-word;background: #'+color+';font-size:22pt;line-height:22pt;min-height:40px;width:100%;" id="title"></div><br\><br\>';
    var theDiv = document.getElementById("title");
    theDiv.innerHTML = '<br><span>' + subjectData[subject][whichTitle] + "</span>" + '<p style="text-align:left;word-wrap:break-word;font-size:12pt;line-height:12pt;"><b>Abstract:</b><br>'+subjectAbstract[subject][whichAbstract]+"</p><br>";    
}
</script>

<center>
<p>
<input style="background: #EF9FAF;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Chemistry" onclick="showRandomTitle('chemistry','EF9FAF');" /><input style="background: #FFCAAA;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Biology" onclick="showRandomTitle('biology','FFCAAA');" /><input style="background: #6FA698;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Medicine" onclick="showRandomTitle('medicine','6FA698');" /><input style="background: #A8DB92;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Pyschology" onclick="showRandomTitle('psychology','A8DB92');" />
</p>
<p>
<input style="background: #7887AB;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Economics" onclick="showRandomTitle('economics','7887AB');" /><input style="background: #9576AB;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="CS" onclick="showRandomTitle('computerscience','9576AB');" /><input style="background: #FFF0AA;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Math" onclick="showRandomTitle('math','FFF0AA');" /><input style="background: #FFE3AA;font-size:18pt;height:40px;width:20%;" id="clickMe" type="button" value="Physics" onclick="showRandomTitle('physics','FFE3AA');" />
</p>
<div id='loading'>
</div>
</center>

<br>

<h3>About:</h3>
<p>
 The dataset was generated by extracting the titles and abstracts from the 18,000 most cited science articles according to the <a href="https://apps.webofknowledge.com">Web of Science</a>. The titles and abstracts for a given subject were then fed into <a href="https://github.com/jsvine/markovify">jsvine's Markov chain generator</a>.
 </p>

<br>
<p>
I also created a word cloud from these titles (which shows it pays to be a cell biologist who studies expression of human protein receptors).
</p>

<center>
<br>
<img src="/flask_words.png" width=300px></img>
</center> 



<br>
<h3>Try it!:</h3>
<p>If you'd like to run the code yourself:</p>

<p><pre>
git clone https://github.com/schollz/topscience.git
cd topscience
python3 -m pip install bibtexparser markovify Pillow numpy
python3 run.py     # get a cup of coffee while you wait for this...
python3 -m http.server 
# Now open your browser to http://localhost:8000
</pre></p>


</body>


 </html>